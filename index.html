<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>üç• GitHub-Powered Masonry Gallery</title>
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      padding:1em;
      background:#f5f5f5;
      font-family:sans-serif;
    }
    .gallery {
  column-width: 250px;  /* ideal width for big screens */
  column-gap: 1em;
}
@media (max-width: 600px) {
  .gallery {
    column-count: 2;     /* always two columns */
    column-width: auto;  /* let them shrink/fluid */
  }
}
    .gallery img {
      width:100%;
      margin-bottom:1em;
      display:inline-block;
      break-inside:avoid;
      cursor:zoom-in;
      transition:transform .2s;
    }
    .gallery img:hover {
      transform:scale(1.03);
    }
    @media (max-width:600px) {
      .gallery { column-count:2; }
    }
  </style>
</head>
<body>
  <div class="gallery" id="gallery"></div>

  <script>
    // ‚îÄ‚îÄ‚îÄ CONFIGURE THESE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const user   = 'pierropropeller';
    const repo   = 'Anniversary-Album';
    const branch = 'main';
    const folder = 'media';  // folder path in your repo
    const treeURL = 
      `https://api.github.com/repos/${user}/${repo}/git/trees/${branch}?recursive=1`;

      async function loadGallery() {
    const resp      = await fetch(treeURL);
    const { tree }  = await resp.json();

    // 1) filter your images‚Ä¶
    const files = tree.filter(f =>
      f.type === 'blob'
      && f.path.startsWith(folder + '/')
      && /\.(jpe?g|png|gif|webp|svg)$/i.test(f.path)
    );

    // 2) map ‚Üí {url,name,sub,date}
    const items = await Promise.all(files.map(async f => {
      const url   = `https://raw.githubusercontent.com/${user}/${repo}/${branch}/${f.path}`;
      const parts = f.path.split('/');
      const sub   = parts[1];
      const name  = parts.pop();
      const date  = await getLastModified(url);
      return { url, name, sub, date };
    }));

    // 3) sort newest‚Üíoldest
    items.sort((a,b) => b.date - a.date);

    // 4) build tabs
    const tabs = [...new Set(items.map(i => i.sub))];
    const tabsEl = document.getElementById('tabs');
    tabs.forEach((sub,i) => {
      const btn = document.createElement('button');
      btn.textContent = sub;
      btn.dataset.sub = sub;
      btn.className   = i===0 ? 'active' : '';
      btn.onclick     = () => switchTab(sub, btn);
      tabsEl.appendChild(btn);
    });

    // ‚Üê‚Äì‚Äì BUGFIX: assign _galleryItems BEFORE calling switchTab
    window._galleryItems = items;

    // 5) initial render
    if (tabs.length) switchTab(tabs[0]);
  }

  function switchTab(sub, btn = null) {
    // update active tab styling
    if (btn) {
      document.querySelectorAll('.tabs button')
              .forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }
    // render the images for this tab
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = '';
    window._galleryItems
      .filter(i => i.sub === sub)
      .forEach(i => {
        const img = document.createElement('img');
        img.src = i.url;
        img.alt = i.name;
        gallery.appendChild(img);
      });
  }

  window.addEventListener('DOMContentLoaded', loadGallery);
</script>
</body>
</html>
